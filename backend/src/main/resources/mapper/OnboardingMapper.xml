<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.dash.onboarding.infrastructure.mapper.OnboardingMapper">

  <resultMap id="OnboardingRepositoryResult" type="Onboarding">
    <id property="id" column="id" />
    <result property="userId" column="user_id" />
    <result property="repositoryName" column="repository_name" />
    <result property="webhookConfigured" column="webhook_configured" />
    <result property="createdAt" column="created_at" />
    <result property="updatedAt" column="updated_at" />
  </resultMap>

  <select id="selectByUserId" parameterType="long" resultMap="OnboardingRepositoryResult">
    SELECT id, user_id, repository_name, webhook_configured, created_at, updated_at
    FROM user_repositories
    WHERE user_id = #{userId}
    LIMIT 1
  </select>

  <insert id="insert" parameterType="Onboarding" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO user_repositories (user_id, repository_name, webhook_configured)
    VALUES (#{userId}, #{repositoryName}, #{webhookConfigured})
  </insert>

  <update id="update" parameterType="Onboarding">
    UPDATE user_repositories
    SET repository_name = #{repositoryName}, webhook_configured = #{webhookConfigured}
    WHERE id = #{id}
  </update>

</mapper>
